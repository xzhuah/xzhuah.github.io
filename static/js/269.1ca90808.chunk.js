"use strict";(self.webpackChunkmy_dimension_client=self.webpackChunkmy_dimension_client||[]).push([[269],{27269:(n,e,t)=>{t.r(e),t.d(e,{default:()=>G});var i=t(65043),o=t(67807),s=t(60446),r=t.n(s),a=t(86068),l=t(74117),c=t(28079),u=t(21012),d=t(26033),m=t(59685);const v={encode(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new u.fI;for(const t of n.userId)e.uint32(10).string(t);return void 0!==n.time&&d.zJ.encode(n.time,e.uint32(18).fork()).join(),0!==n.interval&&e.uint32(24).int64(n.interval),e},decode(n,e){const t=n instanceof u.V5?n:new u.V5(n);let i=void 0===e?t.len:t.pos+e;const o={userId:[],time:void 0,interval:0};for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:if(10!==n)break;o.userId.push(t.string());continue;case 2:if(18!==n)break;o.time=d.zJ.decode(t,t.uint32());continue;case 3:if(24!==n)break;o.interval=b(t.int64());continue}if(4===(7&n)||0===n)break;t.skip(7&n)}return o},fromJSON:n=>({userId:globalThis.Array.isArray(null===n||void 0===n?void 0:n.userId)?n.userId.map((n=>globalThis.String(n))):[],time:A(n.time)?d.zJ.fromJSON(n.time):void 0,interval:A(n.interval)?globalThis.Number(n.interval):0}),toJSON(n){var e;const t={};return null!==(e=n.userId)&&void 0!==e&&e.length&&(t.userId=n.userId),void 0!==n.time&&(t.time=d.zJ.toJSON(n.time)),0!==n.interval&&(t.interval=Math.round(n.interval)),t},create:n=>v.fromPartial(null!==n&&void 0!==n?n:{}),fromPartial(n){var e,t;const i={userId:[],time:void 0,interval:0};return i.userId=(null===(e=n.userId)||void 0===e?void 0:e.map((n=>n)))||[],i.time=void 0!==n.time&&null!==n.time?d.zJ.fromPartial(n.time):void 0,i.interval=null!==(t=n.interval)&&void 0!==t?t:0,i}};const h={encode(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new u.fI;for(const t of n.userActionChains)f.encode(t,e.uint32(10).fork()).join();return e},decode(n,e){const t=n instanceof u.V5?n:new u.V5(n);let i=void 0===e?t.len:t.pos+e;const o={userActionChains:[]};for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:if(10!==n)break;o.userActionChains.push(f.decode(t,t.uint32()));continue}if(4===(7&n)||0===n)break;t.skip(7&n)}return o},fromJSON:n=>({userActionChains:globalThis.Array.isArray(null===n||void 0===n?void 0:n.userActionChains)?n.userActionChains.map((n=>f.fromJSON(n))):[]}),toJSON(n){var e;const t={};return null!==(e=n.userActionChains)&&void 0!==e&&e.length&&(t.userActionChains=n.userActionChains.map((n=>f.toJSON(n)))),t},create:n=>h.fromPartial(null!==n&&void 0!==n?n:{}),fromPartial(n){var e;const t={userActionChains:[]};return t.userActionChains=(null===(e=n.userActionChains)||void 0===e?void 0:e.map((n=>f.fromPartial(n))))||[],t}};const f={encode(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new u.fI;void 0!==n.customer&&m.Qg.encode(n.customer,e.uint32(10).fork()).join();for(const t of n.actions)g.encode(t,e.uint32(18).fork()).join();return e},decode(n,e){const t=n instanceof u.V5?n:new u.V5(n);let i=void 0===e?t.len:t.pos+e;const o={customer:void 0,actions:[]};for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:if(10!==n)break;o.customer=m.Qg.decode(t,t.uint32());continue;case 2:if(18!==n)break;o.actions.push(g.decode(t,t.uint32()));continue}if(4===(7&n)||0===n)break;t.skip(7&n)}return o},fromJSON:n=>({customer:A(n.customer)?m.Qg.fromJSON(n.customer):void 0,actions:globalThis.Array.isArray(null===n||void 0===n?void 0:n.actions)?n.actions.map((n=>g.fromJSON(n))):[]}),toJSON(n){var e;const t={};return void 0!==n.customer&&(t.customer=m.Qg.toJSON(n.customer)),null!==(e=n.actions)&&void 0!==e&&e.length&&(t.actions=n.actions.map((n=>g.toJSON(n)))),t},create:n=>f.fromPartial(null!==n&&void 0!==n?n:{}),fromPartial(n){var e;const t={customer:void 0,actions:[]};return t.customer=void 0!==n.customer&&null!==n.customer?m.Qg.fromPartial(n.customer):void 0,t.actions=(null===(e=n.actions)||void 0===e?void 0:e.map((n=>g.fromPartial(n))))||[],t}};const g={encode(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new u.fI;return""!==n.action&&e.uint32(10).string(n.action),0!==n.actionTime&&e.uint32(16).int64(n.actionTime),""!==n.subChannel&&e.uint32(26).string(n.subChannel),""!==n.sessionId&&e.uint32(34).string(n.sessionId),e},decode(n,e){const t=n instanceof u.V5?n:new u.V5(n);let i=void 0===e?t.len:t.pos+e;const o={action:"",actionTime:0,subChannel:"",sessionId:""};for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:if(10!==n)break;o.action=t.string();continue;case 2:if(16!==n)break;o.actionTime=b(t.int64());continue;case 3:if(26!==n)break;o.subChannel=t.string();continue;case 4:if(34!==n)break;o.sessionId=t.string();continue}if(4===(7&n)||0===n)break;t.skip(7&n)}return o},fromJSON:n=>({action:A(n.action)?globalThis.String(n.action):"",actionTime:A(n.actionTime)?globalThis.Number(n.actionTime):0,subChannel:A(n.subChannel)?globalThis.String(n.subChannel):"",sessionId:A(n.sessionId)?globalThis.String(n.sessionId):""}),toJSON(n){const e={};return""!==n.action&&(e.action=n.action),0!==n.actionTime&&(e.actionTime=Math.round(n.actionTime)),""!==n.subChannel&&(e.subChannel=n.subChannel),""!==n.sessionId&&(e.sessionId=n.sessionId),e},create:n=>g.fromPartial(null!==n&&void 0!==n?n:{}),fromPartial(n){var e,t,i,o;const s={action:"",actionTime:0,subChannel:"",sessionId:""};return s.action=null!==(e=n.action)&&void 0!==e?e:"",s.actionTime=null!==(t=n.actionTime)&&void 0!==t?t:0,s.subChannel=null!==(i=n.subChannel)&&void 0!==i?i:"",s.sessionId=null!==(o=n.sessionId)&&void 0!==o?o:"",s}};function b(n){const e=globalThis.Number(n.toString());if(e>globalThis.Number.MAX_SAFE_INTEGER)throw new globalThis.Error("Value is larger than Number.MAX_SAFE_INTEGER");if(e<globalThis.Number.MIN_SAFE_INTEGER)throw new globalThis.Error("Value is smaller than Number.MIN_SAFE_INTEGER");return e}function A(n){return null!==n&&void 0!==n}var x=t(34834);var p=t(17481),j=t(29479),I=t(13766),C=t(40710),T=t(86605),S=t(88645),w=t(52792),k=t(39336),N=t(9526),J=t(54086),y=t(62973),O=t(21323),_=t(52871),E=t(70579);const P=n=>{let{subChannel:e,...t}=n;return(0,E.jsx)(c.m_,{title:e,enableTranslate:!1,children:(n=>{switch(n){case"api_call":return(0,E.jsx)(N.A,{...t});case"dialog":return(0,E.jsx)(y.A,{...t});case"route":return(0,E.jsx)(O.A,{...t});case"websocket":return(0,E.jsx)(_.A,{...t});default:return(0,E.jsx)(J.A,{...t})}})(e)})},V=n=>{let{userAction:e,sx:t,...i}=n;return(0,E.jsxs)(o.A,{direction:"column",width:"100%",spacing:1,sx:{...t},...i,children:[(0,E.jsxs)(o.A,{direction:"row",justifyContent:"flex-start",spacing:1,alignItems:"center",children:[(0,E.jsx)(P,{subChannel:e.subChannel,fontSize:"large"}),(0,E.jsx)(c.o5,{enableTranslate:!1,variant:"h6",children:new Date(e.actionTime).toLocaleString()}),(0,E.jsx)(c.o5,{enableTranslate:!1,variant:"caption",children:e.sessionId})]}),(0,E.jsx)(o.A,{direction:"row",justifyContent:"flex-start",spacing:1,children:(0,E.jsx)(c.o5,{enableTranslate:!1,enableLinkify:!0,textAlign:"left",children:e.action})}),(0,E.jsx)(k.A,{})]})};var z=t(24548);const M=n=>{var e,t,i,s;let{userActionChain:r,sx:a,...l}=n;const u=new Date(r.actions[0].actionTime),d=new Date(r.actions[r.actions.length-1].actionTime),m=r.actions.length;return(0,E.jsx)(o.A,{width:"100%",sx:{...a},...l,children:(0,E.jsxs)(I.A,{variant:"outlined",slotProps:{transition:{timeout:m>10?0:200}},children:[(0,E.jsx)(T.A,{expandIcon:(0,E.jsx)(S.A,{}),"aria-controls":"panel1-content",id:"panel1-header",children:(0,E.jsxs)(o.A,{direction:"row",alignItems:"center",spacing:2,children:[(0,E.jsx)(w.A,{title:null===(e=r.customer)||void 0===e?void 0:e.name,profileLink:(0,z.MI)(null===(t=r.customer)||void 0===t?void 0:t.id),avatarUrl:null===(i=r.customer)||void 0===i?void 0:i.avatarUrl}),(0,E.jsxs)(c.o5,{justifyContent:"start",enableTranslate:!1,children:[" ",null===(s=r.customer)||void 0===s?void 0:s.name,":"]}),(0,E.jsxs)(c.o5,{justifyContent:"start",enableTranslate:!1,children:[" ",u.toLocaleString()," - ",d.toLocaleString()]}),(0,E.jsxs)(c.o5,{justifyContent:"start",enableTranslate:!1,children:[" ",r.actions.length," "]})]})}),(0,E.jsx)(C.A,{children:(0,E.jsx)(o.A,{direction:"column",spacing:2,children:(0,E.jsx)(j.A,{data:r.actions,renderItem:(n,e)=>(0,E.jsx)(V,{userAction:n},e)})})})]})})};var D=t(74672),Q=t(7399);const G=n=>{let{sx:e,...t}=n;const{t:s}=(0,l.Bd)(),u=(0,D.G)(Q.bX),{showAlert:m}=i.useContext(p.A),[f,g]=i.useState(r()("2024-01-01T00:00")),[b,A]=i.useState(r()()),[I,C]=i.useState(5),[T,S]=i.useState(!1),[w,k]=i.useState((null===u||void 0===u?void 0:u.userId)||""),[N,J]=i.useState([]);return(0,E.jsxs)(o.A,{direction:"column",spacing:2,sx:{...e},...t,children:[(0,E.jsxs)(o.A,{direction:{xs:"column",md:"row"},spacing:{xs:1,md:2},justifyContent:"center",children:[(0,E.jsx)(c.A_,{label:"Customer IDs",type:"text",variant:"outlined",placeholder:"id1, id2,...",value:w,onChange:n=>k(n.target.value)}),(0,E.jsx)(a.K,{label:s("Start Date"),value:f,onChange:n=>g(n)}),(0,E.jsx)(a.K,{label:s("End Date"),value:b,onChange:n=>A(n)}),(0,E.jsx)(c.A_,{label:"Interval (minutes)",type:"number",variant:"outlined",value:I,onChange:n=>C(parseInt(n.target.value))}),(0,E.jsx)(c.lV,{loading:T,variant:"contained",onClick:()=>{S(!0);(function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3e5;const o=v.create(),s=d.zJ.create();return o.userId=n,e&&(s.start=e),t&&(s.end=t),o.time=s,o.interval=i,(0,x.wN)("/api/v0/admin/query_user_action",v,h,o)})(w.length>0?w.split(",").map((n=>n.trim())):[],null===f||void 0===f?void 0:f.valueOf(),null===b||void 0===b?void 0:b.valueOf(),60*I*1e3).then((n=>{J(n.userActionChains)})).catch((n=>{m(n.message,"error")})).finally((()=>{S(!1)}))},children:"Query"})]}),(0,E.jsx)(o.A,{direction:"column",spacing:1,children:(0,E.jsx)(j.A,{data:N,renderItem:(n,e)=>(0,E.jsx)(M,{userActionChain:n},e)})})]})}}}]);
//# sourceMappingURL=269.1ca90808.chunk.js.map