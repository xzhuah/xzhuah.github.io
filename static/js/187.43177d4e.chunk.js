(self.webpackChunkmy_dimension_client=self.webpackChunkmy_dimension_client||[]).push([[187],{95992:(e,n,t)=>{"use strict";t.d(n,{h:()=>r});t(65043);var i=t(67807),a=t(70579);const r=e=>{let{sx:n,...t}=e;return(0,a.jsx)(i.A,{direction:"column",sx:{marginTop:4,marginBottom:8,marginX:{xs:0,sm:2,md:6,lg:24,xl:48},...n},...t})}},46857:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>z});var i=t(65043),a=t(16456),r=t(70579);const s=e=>{let{antialias:n=!0,engineOptions:t,adaptToDeviceRatio:s,sceneOptions:o,onRender:l,onSceneReady:c=()=>{},children:d,...u}=e;const m=(0,i.useRef)(null);return(0,i.useEffect)((()=>{const e=m.current;if(!e)return;const i=new a.N$8(e,n,t,s);i.setHardwareScalingLevel(1/window.devicePixelRatio);const r=new a.Z58(i,o);if(r.isReady())c(r);else try{r.onReadyObservable.addOnce((e=>{try{c(e)}catch(n){console.error(n)}}))}catch(u){console.error(u)}i.runRenderLoop((()=>{"function"===typeof l&&l(r),r.render()}));const d=()=>{r.getEngine().resize()};return window&&window.addEventListener("resize",d),()=>{try{r&&r.getEngine()&&r.getEngine().dispose()}catch(u){console.log(u)}window&&window.removeEventListener("resize",d)}}),[n,t,s,o,l,c]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("canvas",{ref:m,style:{backgroundColor:"black",height:"100svh",width:"100%"},...u}),d]})};var o=t(15213),l=t.n(o),c=(t(25550),t(8738)),d=t(25680),u=t(24010),m=t(63564),h=t(84593),g=t(28079),x=t(67807),p=t(27999),y=t(67649);const f=e=>{const n=e.replace("#",""),t=parseInt(n.substring(0,2),16)/255,i=parseInt(n.substring(2,4),16)/255,r=parseInt(n.substring(4,6),16)/255;return new a.v9j(t,i,r)};var v=t(97629),w=t(79751),j=t(77285),b=t(66921);const A=(0,i.forwardRef)(((e,n)=>{let{lightName:t="pointLight",scene:s,updateSignal:o,initialPosition:l=a.Pq0.Zero(),initialIntensity:c=1,minX:d=-30,maxX:u=30,minY:m=-5,maxY:h=30,minZ:p=-60,maxZ:y=60,step:A=.1,minIntensity:S=0,maxIntensity:I=6,intensityStep:P=.01,showControl:C=!0,sx:L,...R}=e;const z=i.useRef(),k=i.useRef();(0,i.useImperativeHandle)(n,(()=>({getLight:()=>z.current})),[]);const[M,T]=i.useState(!1),[q,E]=i.useState(c),[D,Y]=i.useState("#ffffff"),[_,F]=i.useState({x:null===l||void 0===l?void 0:l.x,y:null===l||void 0===l?void 0:l.y,z:null===l||void 0===l?void 0:l.z});return(0,i.useEffect)((()=>{k.current&&z.current&&(M?(k.current.attachedMesh=z.current,k.current.light=z.current):(k.current.light=null,k.current.attachedMesh=null))}),[M]),(0,i.useEffect)((()=>{if(!s)return;const e=z.current?z.current:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pointLight",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new a.Pq0(0,0,0),i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const r=new a.HiM(n,t,e);return r.intensity=i,r.diffuse.set(1,1,1),r.specular.set(1,1,1),r}(s,t,new a.Pq0(_.x,_.y,_.z),q);if(!z.current){z.current=e;const n=new a.h9J;k.current=n}const n=f(D);z.current.range=100,z.current.diffuse=n,z.current.specular=n,z.current.intensity=q,z.current.position.x=_.x,z.current.position.y=_.y,z.current.position.z=_.z}),[D,q,t,_.x,_.y,_.z,s,o]),s?(0,r.jsxs)(x.A,{direction:"column",maxWidth:"160px",display:C?"flex":"none",onMouseEnter:()=>T(!0),onMouseLeave:()=>T(!1),spacing:1,sx:{...L},...R,children:[(0,r.jsx)(g.o5,{variant:"body1",children:t}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(j.A,{}),(0,r.jsx)(w.TY,{size:"small",margin:"none",adornmentPosition:"end",sx:{padding:0},hiddenLabel:!0,format:"hex",value:D,onChange:Y})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(b.A,{}),(0,r.jsx)(v.Ay,{size:"small",min:S,max:I,step:P,value:q,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{E(n)}})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(g.o5,{variant:"caption",enableTranslate:!1,children:"X:"}),(0,r.jsx)(v.Ay,{size:"small",min:d,max:u,step:A,value:_.x,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{F({..._,x:n})}})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(g.o5,{variant:"caption",enableTranslate:!1,children:"Y:"}),(0,r.jsx)(v.Ay,{size:"small",min:m,max:h,step:A,value:_.y,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{F({..._,y:n})}})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(g.o5,{variant:"caption",enableTranslate:!1,children:"Z:"}),(0,r.jsx)(v.Ay,{size:"small",min:p,max:y,step:A,value:_.z,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{F({..._,z:n})}})]})]}):(0,r.jsx)(r.Fragment,{})})),S=(0,i.forwardRef)(((e,n)=>{let{lightName:t="directionalLight",scene:s,updateSignal:o,initialDirection:l=a.Pq0.Zero(),initialIntensity:c=1,minX:d=-Math.PI,maxX:u=Math.PI,minY:m=-Math.PI,maxY:h=Math.PI,minZ:p=-Math.PI,maxZ:y=Math.PI,step:A=.01,minIntensity:S=0,maxIntensity:I=3,intensityStep:P=.01,showControl:C=!0,sx:L,...R}=e;const z=i.useRef();(0,i.useImperativeHandle)(n,(()=>({getLight:()=>z.current})),[z.current,z]);const[k,M]=i.useState(!1),[T,q]=i.useState(c),[E,D]=i.useState("#ffffff"),[Y,_]=i.useState({x:null===l||void 0===l?void 0:l.x,y:null===l||void 0===l?void 0:l.y,z:null===l||void 0===l?void 0:l.z});return(0,i.useEffect)((()=>{if(!s)return;const e=z.current?z.current:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"directionalLight",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.Pq0.Up(),i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const r=new a.ZyN(n,t,e);return r.intensity=i,r.diffuse.set(1,1,1),r.specular.set(1,1,1),r}(s,t,new a.Pq0(0,0,0),1);z.current||(z.current=e,R.onLightAdd&&R.onLightAdd(e));const n=f(E);z.current.diffuse=n,z.current.specular=n,z.current.intensity=T,z.current.direction.x=Y.x,z.current.direction.y=Y.y,z.current.direction.z=Y.z}),[E,T,t,Y.x,Y.y,Y.z,s,o]),s?(0,r.jsxs)(x.A,{direction:"column",maxWidth:"160px",display:C?"flex":"none",onMouseEnter:()=>M(!0),onMouseLeave:()=>M(!1),spacing:1,sx:{...L},...R,children:[(0,r.jsx)(g.o5,{variant:"body1",children:t}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(j.A,{}),(0,r.jsx)(w.TY,{size:"small",margin:"none",adornmentPosition:"end",sx:{padding:0},hiddenLabel:!0,format:"hex",value:E,onChange:D})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(b.A,{}),(0,r.jsx)(v.Ay,{size:"small",min:S,max:I,step:P,value:T,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{q(n)}})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(g.o5,{variant:"caption",enableTranslate:!1,children:"X:"}),(0,r.jsx)(v.Ay,{size:"small",min:d,max:u,step:A,value:Y.x,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{_({...Y,x:n})}})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(g.o5,{variant:"caption",enableTranslate:!1,children:"Y:"}),(0,r.jsx)(v.Ay,{size:"small",min:m,max:h,step:A,value:Y.y,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{_({...Y,y:n})}})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(g.o5,{variant:"caption",enableTranslate:!1,children:"Z:"}),(0,r.jsx)(v.Ay,{size:"small",min:p,max:y,step:A,value:Y.z,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{_({...Y,z:n})}})]})]}):(0,r.jsx)(r.Fragment,{})})),I=(0,i.forwardRef)(((e,n)=>{let{lightName:t="hemisphericLight",scene:s,updateSignal:o,initialIntensity:l=1,showControl:c=!0,step:d=.1,minIntensity:u=0,maxIntensity:m=1.5,intensityStep:h=.01,linkEnvironment:p=!0,sx:y,...A}=e;const S=i.useRef();(0,i.useImperativeHandle)(n,(()=>({getLight:()=>S.current})),[]);const[I,P]=i.useState(l),[C,L]=i.useState("#ffffff"),[R,z]=i.useState("#000000");return(0,i.useEffect)((()=>{if(!s)return;const e=S.current?S.current:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hemisphericLight",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const i=new a.g4z(n,a.Pq0.Up(),e);return i.intensity=t,i.diffuse.set(1,1,1),i.specular.set(1,1,1),i.groundColor.set(0,0,0),i}(s,t,I);S.current||(S.current=e);const n=f(C),i=f(R);S.current.diffuse=n,S.current.specular=n,S.current.intensity=I,S.current.groundColor=i,p&&(s.environmentIntensity=I)}),[C,R,I,t,s,o]),s?(0,r.jsxs)(x.A,{direction:"column",maxWidth:"160px",display:c?"flex":"none",spacing:1,sx:{...y},...A,children:[(0,r.jsx)(g.o5,{variant:"body1",children:t}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(j.A,{}),(0,r.jsx)(w.TY,{size:"small",margin:"none",adornmentPosition:"end",sx:{padding:0},hiddenLabel:!0,format:"hex",value:C,onChange:L})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(j.A,{}),(0,r.jsx)(w.TY,{size:"small",margin:"none",adornmentPosition:"end",sx:{padding:0},hiddenLabel:!0,format:"hex",value:R,onChange:z})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(b.A,{}),(0,r.jsx)(v.Ay,{size:"small",min:u,max:m,step:h,value:I,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{P(n)}})]})]}):(0,r.jsx)(r.Fragment,{})}));var P=t(95992),C=t(44843),L=t(52633);const R=(0,y.RW)(301),z=()=>{const[e,n]=i.useState(!1),[t,o]=i.useState(!1),y=i.useRef(),f=i.useRef(),v=i.useRef(),w=i.useRef(),j=i.useRef(),b=i.useRef(),z=i.useRef(),k=i.useRef(),M=i.useRef(),T=i.useRef(),q=(0,i.useCallback)((async e=>{var n,i;e.ambientColor=new a.v9j(.5,.5,.5);const r=e.getEngine().getRenderingCanvas();y.current=e,o(!t);const s=function(e,n,t){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"arcCamera";const r=(arguments.length>4?arguments[4]:void 0)||new a.Pq0(0,0,0),s=t.subtract(r).length(),o=new a.Lqh(i,0,0,s,t,e);return o.setPosition(r),o.maxZ=1e3,o.attachControl(n,!0,!0),o.wheelDeltaPercentage=.01,o.panningSensibility=200,o.angularSensibilityX=6e3,o.angularSensibilityY=6e3,o}(e,r,new a.Pq0(0,10,20),"arcCamera",new a.Pq0(0,10,-20));window.onkeydown=e=>{!function(e,n){let t=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5;if(!e)return;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.1;(n.shiftKey||n.ctrlKey)&&(r*=t,s*=i);const o=e.getFrontPosition(1),l=e.position;if("w"===n.key||"ArrowUp"===n.key||"W"===n.key){const n=o.subtract(l);e.target.addInPlace(n.multiplyByFloats(r,r,r))}if("s"===n.key||"ArrowDown"===n.key||"S"===n.key){const n=o.subtract(l);e.target.subtractInPlace(n.multiplyByFloats(r,r,r))}if("a"===n.key||"ArrowLeft"===n.key||"A"===n.key){const n=o.subtract(l),t=a.Pq0.Cross(n,a.Pq0.Up());e.target.addInPlace(t.multiplyByFloats(s,s,s))}if("d"===n.key||"ArrowRight"===n.key||"D"===n.key){const n=o.subtract(l),t=a.Pq0.Cross(n,a.Pq0.Up());e.target.subtractInPlace(t.multiplyByFloats(s,s,s))}}(s,e)};const u=s;if(e.activeCamera=u,k.current=u,!c.Fr){const n=new a.Hgh("/mmd/res/ocean_view_balcony_4k.hdr",e,512,!1,!0,!1,!0);n.rotationY=Math.PI/2*3,z.current=n;e.createDefaultSkybox(n,!0,1e3).rotation.y=Math.PI/2*3}const m=a.PeD.CreateGround("ground1",{width:60,height:60,subdivisions:1,updatable:!1},e);m.position.y=.01,m.position.z=20,M.current=m,m.receiveShadows=!0;const h=new a.YOq("mirrorMaterial",e),g=new a.B2G("mirror",{ratio:1},e,!0);g.mirrorPlane=new a.Zcv(0,-1,0,0),g.renderList=e.meshes,h.reflectionTexture=g,h.metallic=1,h.roughness=0,m.material=h;const x=new d.d5(e),[p,v,A,S]=await Promise.all([(0,a.kSb)("/mmd/\u539f\u795e-\u523b\u6674/\u523b\u6674fix.pmx",e).then((e=>(e.addAllToScene(),e.meshes[0]))).catch((e=>{console.error(e)})),(0,a.kSb)("/mmd/RedialC_AloneTai/AloneTai.pmx",e).then((e=>(e.addAllToScene(),e.meshes[0]))).catch((e=>{console.error(e)})),x.loadAsync("model_motion_1",["/mmd/motion/jimingyue-motion.vmd"]),l()().then((e=>new d.tL(!0,e))).catch((e=>{console.error(e)}))]);if(!p||!A||!S||!v)return;T.current=p,(0,C.yy)("mmdMesh",T.current,w.current),p.renderingGroupId=1,v.renderingGroupId=1,e.enablePhysics(new a.Pq0(0,-9.8,0),S);const I=new d.jQ(e,new d.oV(e));f.current=I,I.register(e),I.setAudioPlayer(((e,n)=>{const t=new d.Ad(e);return t.source=n,t})(e,"mmd/music/\u5bc4\u660e\u6708.mp3"));const P=new a.VR0("mmdRoot",e);P.position.z=20,p.parent=P,v.parent=P,v.position.z=-80;for(const t of p.metadata.meshes)t.receiveShadows=!0;for(const t of v.metadata.meshes)t.receiveShadows=!0;const L=I.createMmdModel(p);if(b.current=L,L.addAnimation(A),L.setAnimation("model_motion_1"),null!==(n=w.current)&&void 0!==n&&n.getLight()){var R;const e=new a.owA(2048,null===(R=w.current)||void 0===R?void 0:R.getLight(),!0,u);e.transparencyShadow=!0,e.bias=.001,e.darkness=0,e.addShadowCaster(m),e.addShadowCaster(p),e.addShadowCaster(v)}if(null!==(i=j.current)&&void 0!==i&&i.getLight()){var q;const e=new a.owA(2048,null===(q=j.current)||void 0===q?void 0:q.getLight(),!0,u);e.transparencyShadow=!0,e.bias=.001,e.darkness=0,e.addShadowCaster(m),e.addShadowCaster(p),e.addShadowCaster(v)}(0,C.yy)("Added shadow")}),[]),E=(0,i.useCallback)((e=>{f.current&&f.current.currentFrameTime>=f.current.animationFrameTimeDuration&&(f.current.seekAnimation(0),f.current.playAnimation())}),[]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s,{antialias:!0,onSceneReady:q,onRender:E,id:"my-canvas",children:(0,r.jsxs)(x.A,{direction:"row",justifyContent:"space-around",alignItems:"flex-start",sx:{marginX:2},children:[(0,r.jsx)(I,{scene:y.current,updateSignal:t,ref:v,initialIntensity:.6}),(0,r.jsx)(S,{scene:y.current,updateSignal:t,ref:w,initialIntensity:.36,initialDirection:new a.Pq0(.5,-1,1)}),(0,r.jsx)(A,{scene:y.current,updateSignal:t,ref:j,initialIntensity:.8,initialPosition:new a.Pq0(3,15,-10)})]})}),(0,r.jsx)(u.A,{color:"primary","aria-label":"add",onClick:()=>{f.current&&(e?f.current.pauseAnimation():f.current.playAnimation()),n(!e)},style:{margin:0,left:20,top:20,right:"auto",bottom:"auto",position:"fixed"},children:e?(0,r.jsx)(m.A,{}):(0,r.jsx)(h.A,{})}),(0,r.jsxs)(P.h,{spacing:2,children:[(0,r.jsx)(g.o5,{children:"Model BY: miHoYo/\u89c2\u6d77\u5b50, Motion By: Nivsha, Stage By: RedialC"}),(0,r.jsx)(L.A,{resourceId:R,resourceType:p.vt.RESOURCE_TYPE_WEBPAGE})]})]})}},2475:()=>{}}]);
//# sourceMappingURL=187.43177d4e.chunk.js.map