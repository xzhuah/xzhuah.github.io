(self.webpackChunkmy_dimension_client=self.webpackChunkmy_dimension_client||[]).push([[187],{95992:(e,n,t)=>{"use strict";t.d(n,{h:()=>r});t(65043);var i=t(67807),a=t(70579);const r=e=>{let{sx:n,...t}=e;return(0,a.jsx)(i.A,{direction:"column",sx:{marginTop:4,marginBottom:8,marginX:{xs:0,sm:2,md:6,lg:24,xl:48},...n},...t})}},46857:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>k});var i=t(65043),a=t(16456),r=t(70579);const s=e=>{let{antialias:n=!0,engineOptions:t,adaptToDeviceRatio:s,sceneOptions:o,onRender:l,onSceneReady:c=()=>{},children:u,...d}=e;const m=(0,i.useRef)(null);return(0,i.useEffect)((()=>{const e=m.current;if(!e)return;const i=new a.N$8(e,n,t,s);i.setHardwareScalingLevel(1/window.devicePixelRatio);const r=new a.Z58(i,o);if(r.isReady())c(r);else try{r.onReadyObservable.addOnce((e=>{try{c(e)}catch(n){console.error(n)}}))}catch(d){console.error(d)}i.runRenderLoop((()=>{"function"===typeof l&&l(r),r.render()}));const u=()=>{r.getEngine().resize()};return window&&window.addEventListener("resize",u),()=>{try{r&&r.getEngine()&&r.getEngine().dispose()}catch(d){console.log(d)}window&&window.removeEventListener("resize",u)}}),[n,t,s,o,l,c]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("canvas",{ref:m,style:{backgroundColor:"black",height:"100svh",width:"100%"},...d}),u]})};var o=t(15213),l=t.n(o),c=(t(25550),t(8738)),u=t(25680),d=t(24010),m=t(63564),h=t(84593),g=t(28079),x=t(67807),p=t(95088),y=t(27999),f=t(67649);const v=e=>{const n=e.replace("#",""),t=parseInt(n.substring(0,2),16)/255,i=parseInt(n.substring(2,4),16)/255,r=parseInt(n.substring(4,6),16)/255;return new a.v9j(t,i,r)};var w=t(97629),j=t(44843),b=t(79751),A=t(77285),P=t(66921);const S=e=>{let{lightName:n="pointLight",scene:t,updateSignal:s,initialPosition:o=a.Pq0.Zero(),minX:l=-30,maxX:c=30,minY:u=-5,maxY:d=30,minZ:m=-60,maxZ:h=60,step:p=.1,showControl:y=!0,sx:f,...S}=e;const C=i.useRef(),I=i.useRef(),[z,L]=i.useState(!1),[k,R]=i.useState(1),[M,q]=i.useState("#ffffff"),[D,E]=i.useState({x:null===o||void 0===o?void 0:o.x,y:null===o||void 0===o?void 0:o.y,z:null===o||void 0===o?void 0:o.z});return(0,i.useEffect)((()=>{I.current&&C.current&&((0,j.yy)("showDebug",z),z?(I.current.attachedMesh=C.current,I.current.light=C.current):(I.current.light=null,I.current.attachedMesh=null))}),[z]),(0,i.useEffect)((()=>{if(!t)return;const e=C.current?C.current:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pointLight",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new a.Pq0(0,0,0),i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const r=new a.HiM(n,t,e);return r.intensity=i,r.diffuse.set(1,1,1),r.specular.set(1,1,1),r}(t,n,new a.Pq0(0,0,0),1);if(!C.current){C.current=e;const n=new a.h9J;I.current=n}const i=v(M);C.current.range=100,C.current.diffuse=i,C.current.specular=i,C.current.intensity=k,C.current.position.x=D.x,C.current.position.y=D.y,C.current.position.z=D.z}),[M,k,n,D.x,D.y,D.z,t,s]),t?(0,r.jsxs)(x.A,{direction:"column",maxWidth:"160px",display:y?"flex":"none",onMouseEnter:()=>L(!0),onMouseLeave:()=>L(!1),spacing:1,sx:{...f},...S,children:[(0,r.jsx)(g.o5,{variant:"body1",children:n}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(A.A,{}),(0,r.jsx)(b.TY,{size:"small",margin:"none",adornmentPosition:"end",sx:{padding:0},hiddenLabel:!0,format:"hex",value:M,onChange:q})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(P.A,{}),(0,r.jsx)(w.Ay,{size:"small",min:0,max:10,step:p,value:k,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{R(n)}})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(g.o5,{variant:"caption",enableTranslate:!1,children:"X:"}),(0,r.jsx)(w.Ay,{size:"small",min:l,max:c,step:p,value:D.x,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{E({...D,x:n})}})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(g.o5,{variant:"caption",enableTranslate:!1,children:"Y:"}),(0,r.jsx)(w.Ay,{size:"small",min:u,max:d,step:p,value:D.y,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{E({...D,y:n})}})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(g.o5,{variant:"caption",enableTranslate:!1,children:"Z:"}),(0,r.jsx)(w.Ay,{size:"small",min:m,max:h,step:p,value:D.z,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{E({...D,z:n})}})]})]}):(0,r.jsx)(r.Fragment,{})},C=e=>{let{lightName:n="directionalLight",scene:t,updateSignal:s,initialDirection:o=a.Pq0.Zero(),minX:l=-Math.PI,maxX:c=Math.PI,minY:u=-Math.PI,maxY:d=Math.PI,minZ:m=-Math.PI,maxZ:h=Math.PI,step:p=.01,showControl:y=!0,sx:f,...j}=e;const S=i.useRef(),[C,I]=i.useState(!1),[z,L]=i.useState(1),[k,R]=i.useState("#ffffff"),[M,q]=i.useState({x:null===o||void 0===o?void 0:o.x,y:null===o||void 0===o?void 0:o.y,z:null===o||void 0===o?void 0:o.z});return(0,i.useEffect)((()=>{if(!t)return;const e=S.current?S.current:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"directionalLight",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.Pq0.Up(),i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const r=new a.ZyN(n,t,e);return r.intensity=i,r.diffuse.set(1,1,1),r.specular.set(1,1,1),r}(t,n,new a.Pq0(0,0,0),1);S.current||(S.current=e);const i=v(k);S.current.diffuse=i,S.current.specular=i,S.current.intensity=z,S.current.direction.x=M.x,S.current.direction.y=M.y,S.current.direction.z=M.z}),[k,z,n,M.x,M.y,M.z,t,s]),t?(0,r.jsxs)(x.A,{direction:"column",maxWidth:"160px",display:y?"flex":"none",onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1),spacing:1,sx:{...f},...j,children:[(0,r.jsx)(g.o5,{variant:"body1",children:n}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(A.A,{}),(0,r.jsx)(b.TY,{size:"small",margin:"none",adornmentPosition:"end",sx:{padding:0},hiddenLabel:!0,format:"hex",value:k,onChange:R})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(P.A,{}),(0,r.jsx)(w.Ay,{size:"small",min:0,max:10,step:p,value:z,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{L(n)}})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(g.o5,{variant:"caption",enableTranslate:!1,children:"X:"}),(0,r.jsx)(w.Ay,{size:"small",min:l,max:c,step:p,value:M.x,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{q({...M,x:n})}})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(g.o5,{variant:"caption",enableTranslate:!1,children:"Y:"}),(0,r.jsx)(w.Ay,{size:"small",min:u,max:d,step:p,value:M.y,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{q({...M,y:n})}})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(g.o5,{variant:"caption",enableTranslate:!1,children:"Z:"}),(0,r.jsx)(w.Ay,{size:"small",min:m,max:h,step:p,value:M.z,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{q({...M,z:n})}})]})]}):(0,r.jsx)(r.Fragment,{})},I=e=>{let{lightName:n="hemisphericLight",scene:t,updateSignal:s,initialIntensity:o=1,showControl:l=!0,step:c=.1,linkEnvironment:u=!0,sx:d,...m}=e;const h=i.useRef(),[p,y]=i.useState(o),[f,j]=i.useState("#ffffff"),[S,C]=i.useState("#000000");return(0,i.useEffect)((()=>{if(!t)return;const e=h.current?h.current:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hemisphericLight",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const i=new a.g4z(n,a.Pq0.Up(),e);return i.intensity=t,i.diffuse.set(1,1,1),i.specular.set(1,1,1),i.groundColor.set(0,0,0),i}(t,n,p);h.current||(h.current=e);const i=v(f),r=v(S);h.current.diffuse=i,h.current.specular=i,h.current.intensity=p,h.current.groundColor=r,u&&(t.environmentIntensity=p)}),[f,S,p,n,t,s]),t?(0,r.jsxs)(x.A,{direction:"column",maxWidth:"160px",display:l?"flex":"none",spacing:1,sx:{...d},...m,children:[(0,r.jsx)(g.o5,{variant:"body1",children:n}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(A.A,{}),(0,r.jsx)(b.TY,{size:"small",margin:"none",adornmentPosition:"end",sx:{padding:0},hiddenLabel:!0,format:"hex",value:f,onChange:j})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(A.A,{}),(0,r.jsx)(b.TY,{size:"small",margin:"none",adornmentPosition:"end",sx:{padding:0},hiddenLabel:!0,format:"hex",value:S,onChange:C})]}),(0,r.jsxs)(x.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,r.jsx)(P.A,{}),(0,r.jsx)(w.Ay,{size:"small",min:0,max:3,step:c,value:p,"aria-label":"Small",valueLabelDisplay:"auto",onChange:(e,n)=>{y(n)}})]})]}):(0,r.jsx)(r.Fragment,{})};var z=t(95992);const L=(0,f.RW)(301),k=()=>{const[e,n]=i.useState(!1),[t,o]=i.useState(!1),f=i.useRef(),v=i.useRef(),w=i.useRef(),j=i.useRef(),b=(0,i.useCallback)((async e=>{e.ambientColor=new a.v9j(.5,.5,.5);const n=e.getEngine().getRenderingCanvas();f.current=e,o(!t);const i=function(e,n,t){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"arcCamera";const r=(arguments.length>4?arguments[4]:void 0)||new a.Pq0(0,0,0),s=t.subtract(r).length(),o=new a.Lqh(i,0,0,s,t,e);return o.setPosition(r),o.maxZ=1e3,o.attachControl(n,!0,!0),o.invertRotation=!0,o.wheelDeltaPercentage=.01,o.panningSensibility=200,o.angularSensibilityX=6e3,o.angularSensibilityY=6e3,o}(e,n,new a.Pq0(0,10,20),"arcCamera",new a.Pq0(0,10,-20));window.onkeydown=e=>{!function(e,n){let t=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5;if(!e)return;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.1;(n.shiftKey||n.ctrlKey)&&(r*=t,s*=i);const o=e.getFrontPosition(1),l=e.position;if("w"===n.key||"ArrowUp"===n.key||"W"===n.key){const n=o.subtract(l);e.target.addInPlace(n.multiplyByFloats(r,r,r))}if("s"===n.key||"ArrowDown"===n.key||"S"===n.key){const n=o.subtract(l);e.target.subtractInPlace(n.multiplyByFloats(r,r,r))}if("a"===n.key||"ArrowLeft"===n.key||"A"===n.key){const n=o.subtract(l),t=a.Pq0.Cross(n,a.Pq0.Up());e.target.addInPlace(t.multiplyByFloats(s,s,s))}if("d"===n.key||"ArrowRight"===n.key||"D"===n.key){const n=o.subtract(l),t=a.Pq0.Cross(n,a.Pq0.Up());e.target.subtractInPlace(t.multiplyByFloats(s,s,s))}}(i,e)};const r=i;if(e.activeCamera=r,!c.Fr){const n=new a.Hgh("/mmd/res/ocean_view_balcony_4k.hdr",e,512,!1,!0,!1,!0);n.rotationY=Math.PI/2*3,j.current=n;e.createDefaultSkybox(n,!0,1e3).rotation.y=Math.PI/2*3}const s=a.PeD.CreateGround("ground1",{width:120,height:120,subdivisions:2,updatable:!1},e);s.receiveShadows=!0;const d=new a.YOq("mirrorMaterial",e),m=new a.B2G("mirror",{ratio:1},e,!0);m.mirrorPlane=new a.Zcv(0,-1,0,0),m.renderList=e.meshes,d.reflectionTexture=m,d.metallic=1,d.roughness=0,s.material=d;const h=new u.d5(e),[g,x,p]=await Promise.all([(0,a.kSb)("/mmd/\u539f\u795e-\u523b\u6674/\u523b\u6674fix.pmx",e).then((e=>(e.addAllToScene(),e.meshes[0]))).catch((e=>{console.error(e)})),h.loadAsync("model_motion_1",["/mmd/motion/jimingyue-motion.vmd"]),l()().then((e=>new u.tL(!0,e))).catch((e=>{console.error(e)}))]);if(!g||!x||!p)return;g.renderingGroupId=1,e.enablePhysics(new a.Pq0(0,-9.8,0),p);const y=new u.jQ(e,new u.oV(e));v.current=y,y.register(e),y.setAudioPlayer(((e,n)=>{const t=new u.Ad(e);return t.source=n,t})(e,"mmd/music/\u5bc4\u660e\u6708.mp3"));const b=new a.VR0("mmdRoot",e);b.position.z=20,g.parent=b;for(const t of g.metadata.meshes)t.receiveShadows=!0;const A=y.createMmdModel(g);w.current=A,A.addAnimation(x),A.setAnimation("model_motion_1")}),[]),A=(0,i.useCallback)((e=>{v.current&&v.current.currentFrameTime>=v.current.animationFrameTimeDuration&&(v.current.seekAnimation(0),v.current.playAnimation())}),[]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s,{antialias:!0,onSceneReady:b,onRender:A,id:"my-canvas",children:(0,r.jsxs)(x.A,{direction:"row",justifyContent:"space-around",alignItems:"flex-start",sx:{marginX:2},children:[(0,r.jsx)(I,{scene:f.current,updateSignal:t,initialIntensity:.7}),(0,r.jsx)(C,{scene:f.current,updateSignal:t,initialDirection:new a.Pq0(.5,-1,1)}),(0,r.jsx)(S,{scene:f.current,updateSignal:t,initialPosition:new a.Pq0(3,15,-10)})]})}),(0,r.jsx)(d.A,{color:"primary","aria-label":"add",onClick:()=>{v.current&&(e?v.current.pauseAnimation():v.current.playAnimation()),n(!e)},style:{margin:0,left:20,top:20,right:"auto",bottom:"auto",position:"fixed"},children:e?(0,r.jsx)(m.A,{}):(0,r.jsx)(h.A,{})}),(0,r.jsxs)(z.h,{spacing:2,children:[(0,r.jsx)(g.o5,{children:"Model BY: miHoYo/\u89c2\u6d77\u5b50, Motion By: Nivsha"}),(0,r.jsx)(p.A,{objectId:L,targetType:y.vt.RESOURCE_TYPE_WEBPAGE})]})]})}},2475:()=>{}}]);
//# sourceMappingURL=187.750d532d.chunk.js.map